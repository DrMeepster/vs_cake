//-----------------------------------------------------------------------
//------------------- Copyright (c) samisalreadytaken -------------------
//                       github.com/samisalreadytaken
//-----------------------------------------------------------------------
if("Glow"in::getroottable())if(typeof::Glow=="table")if("Set"in::Glow)return;;;;::Glow<-{function Set(src,color,style,dist){local glow=Get(src);if(glow)::print("Glow.Set: Entity already has a linked glow; enabling.\n");else{while(glow=::Ent(_NAME_,glow)){local p=glow.GetMoveParent();if(!p||!p.IsValid())break}if(glow)glow.SetModel(src.GetModelName());else{glow=::CreateProp("prop_dynamic_glow",src.GetOrigin(),src.GetModelName(),0);::VS.SetName(glow,_NAME_)};::VS.SetKeyInt(glow,"rendermode",6);::VS.SetKeyInt(glow,"renderamt",0);::VS.SetParent(glow,src);::VS.MakePermanent(glow)};::Assert(glow.GetName()==_NAME_);::VS.SetKeyInt(glow,"glowstyle",style);::VS.SetKeyInt(glow,"glowdist",dist);::VS.SetKey(glow,"glowcolor",color);::VS.SetKeyInt(glow,"glowenabled",1);::VS.SetKeyInt(glow,"effects",EF_DEFAULT);return glow}function Enable(src){local glow=Get(src);if(glow){::VS.SetKeyInt(glow,"effects",EF_DEFAULT);::VS.SetKeyInt(glow,"glowenabled",1)}else::print("Glow.Enable: No glow found.\n");return glow}function Disable(src){local glow=Get(src);if(glow){::VS.SetKeyInt(glow,"effects",EF_DEFAULT|EF_NODRAW);::VS.SetParent(glow,null);::EntFireByHandle(glow,"setglowdisabled")}else::print("Glow.Disable: No glow found.\n");return glow}function Get(src){if(::VS.IsPointSized(src)||!src.GetModelName().len())throw"Glow: Invalid source entity";local p;while(p=::Ent(_NAME_,p))if(p.GetMoveParent()==src)return p}_NAME_="vs.glow",EF_DEFAULT=(1<<0|1<<11)|1<<14,EF_NODRAW=1<<5}
